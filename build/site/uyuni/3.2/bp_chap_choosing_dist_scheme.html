<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Managing Your Subscriptions :: Uyuni Documentation (Prototype)</title>
    <meta name="generator" content="Antora 1.0.3">
    <link rel="stylesheet" href="../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../..">Uyuni Documentation (Prototype)</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Resource A</a>
            <a class="navbar-item" href="#">Resource B</a>
            <a class="navbar-item" href="#">Resource C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="main-wrapper">
<div class="navigation-container" data-component="uyuni" data-version="3.2">
  <aside class="navigation">
    <div class="panels">
<div class="navigation-explore is-active" data-panel="explore">
  <div class="context">
    <span class="title">Uyuni</span>
    <span class="version">3.2</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Uyuni</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../dev/MAIN-manager.html">dev</a>
        </li>
        <li class="version is-current">
          <a href="MAIN-manager.html">3.2</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
  <main class="main">
<div class="toolbar" role="navigation">
  <button class="navigation-toggle"></button>
  <a href="../dev/MAIN-manager.html" class="home-link"></a>
<nav class="crumbs" aria-label="breadcrumbs">
  <ul>
    <li class="crumb"><a href="MAIN-manager.html">Uyuni</a></li>
    <li class="crumb"><a href="bp_chap_choosing_dist_scheme.html">Managing Your Subscriptions</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="versions-menu-toggle" title="Show other versions of page">3.2</button>
  <div class="versions-menu">
    <a class="version" href="../dev/bp_chap_choosing_dist_scheme.html">dev</a>
    <a class="version is-current" href="bp_chap_choosing_dist_scheme.html">3.2</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/jcayouette/uyuni-doc-test/edit/maintenance/3.2/docs/modules/ROOT/pages/bp_chap_choosing_dist_scheme.adoc">Edit this Page</a></div>
</div>
<article class="doc">
<h1>Managing Your Subscriptions</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#scc">SUSE Customer Center (SCC)</a></li>
<li><a href="#disconnect-setup">Disconnected Setup with RMT or SMT (DMZ)</a>
<ul class="sectlevel2">
<li><a href="#rmtool">{rmtool} (RMT) and Disconnected Setup (DMZ)</a></li>
<li><a href="#sub.mgr.tool">{smtool} (SMT) and Disconnected Setup (DMZ)</a></li>
<li><a href="#disconnect.mgr.update-repos">Updating Repositories on  From Storage Media</a></li>
<li><a href="#_refreshing_data_on_the_storage_medium">Refreshing Data on the Storage Medium</a></li>
</ul>
</li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>There are two methods for managing your subscriptions.
Both methods access SUSE Customer Center
and provide specialized benefits.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Directly connecting to SUSE Customer Center is the recommended default way of managing your  server.</p>
</li>
<li>
<p>If you have special network security requirements which do not allow access from your internal network to the internet then you can use SUSE Linux Enterprise Server 12 running the {rmtool} (RMT) or {smtool} (SMT).  These tools will contact SUSE Customer Center from a system connected to the external network and obtain updates for your clients which you may then mount on your internal  server. This is the preferred method for managing client systems within a highly secure network infrastructure.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="scc"><a class="anchor" href="#scc"></a><a class="link" href="#scc">SUSE Customer Center (SCC)</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>SUSE Customer Center
(SCC) is the central place to manage your purchased SUSE
subscriptions, helping you access your update channels and get in contact with SUSE
experts.
The user-friendly interface gives you a centralized view of all your SUSE
subscriptions, allowing you to easily find all subscription information you need.
The improved registration provides faster access to your patches and updates. SUSE Customer Center
is also designed to provide a common platform for your support requests and feedback.
Discover a new way of managing your SUSE
account and subscriptions via one interface&#8212;&#8203;anytime, anywhere.
For more information on using SUSE Customer Center
, see <a href="https://scc.suse.com/docs/userguide" class="bare">https://scc.suse.com/docs/userguide</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="disconnect-setup"><a class="anchor" href="#disconnect-setup"></a><a class="link" href="#disconnect-setup">Disconnected Setup with RMT or SMT (DMZ)</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>If it is not possible to connect 
directly or via a proxy to the Internet, a disconnected setup in combination with RMT or SMT is the recommended solution.
In this scenario, RMT or SMT stays in an &#8220;external&#8221;
 network with a connection to SUSE Customer Center
 and synchronizes the software channels and repositories on a removable storage medium.
Then you separate the storage medium from RMT or SMT, and mount it locally on your 
 server to read the updated data.</p>
</div>
<div class="paragraph">
<div class="title">RMT</div>
<p>The successor of SMT and currently runs on the following systems:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SUSE Linux Enterprise 15 (when available)</p>
</li>
<li>
<p>Temporarily (for testing only): 12 SP2, and 12 SP3</p>
</li>
<li>
<p>Not officially supported: openSUSE Leap 42.2, Leap 42.3, and openSUSE Tumbleweed</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>RMT allows you to provision updates for all of your devices running a product based on SUSE Linux Enterprise
 12 SPx and later as well as openSUSE Leap.</p>
</div>
<div class="paragraph">
<div class="title">SMT</div>
<p>The predecessor of RMT and is no longer actively developed.
It runs on SUSE Linux Enterprise Server
 12 SPx and allows you to provision updates for products based on SUSE Linux Enterprise
 12 SPx and earlier.
You will still need it, if you want to update SUSE Linux Enterprise
 11 clients.</p>
</div>
<div class="sect2">
<h3 id="rmtool"><a class="anchor" href="#rmtool"></a><a class="link" href="#rmtool">{rmtool} (RMT) and Disconnected Setup (DMZ)</a></h3>
<div class="paragraph">
<p>The following procedure will guide you through using RMT.
It will work best with a dedicated RMT instance per 
.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure: RMT: Fetching Repository Data from SUSE Customer Center</div>
<ol class="arabic">
<li>
<p>Configure RMT in the external network with SCC. For details about configuring RMT, see the official guide (when available).</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Preparation work:</p>
<div class="paragraph">
<p>Run <code class="command">rmt-cli sync</code> to download available products and repositories data for your organization from SCC.</p>
</div>
<div class="paragraph">
<p>Run <code class="command">rmt-cli products list --all</code> to see the list of products that are available for your organization.</p>
</div>
<div class="paragraph">
<p>Run <code class="command">rmt-cli repos list --all</code> to see the list of all repositories available.</p>
</div>
</li>
<li>
<p>With <code class="command">rmt-cli repos enable</code> enable repositories you want to mirror.</p>
</li>
<li>
<p>With <code class="command">rmt-cli products enable</code>enable products. For example, to enable SLES _15:</p>
<div class="listingblock">
<div class="content">
<pre>rmt-cli product enable sles/15/x86_64</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Using RMT, mirror all required repositories.</p>
</li>
<li>
<p>Get the required JSON responses from SCC and save them as files at the specified path (for example, <code class="path">/mnt/usb</code> ).</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title=":heavy_exclamation_mark:"></i>
</td>
<td class="content">
<div class="title">Write Permissions for RMT User</div>
The directory being written to must be writeable for the same user as the rmt service.
The rmt user setting is defined in the <code>cli</code> section of <code class="path">/etc/rmt.conf</code>
.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Enter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{prompt.root}rmt-cli export data /mnt/usb</pre>
</div>
</div>
</li>
<li>
<p>Export settings about repositories to mirror to the specified path (in this case, <code class="path">/mnt/usb</code> ); this command will create a <code class="path">repos.json</code> file there:</p>
<div class="listingblock">
<div class="content">
<pre>{prompt.root}rmt-cli export settings /mnt/usb</pre>
</div>
</div>
</li>
<li>
<p>Mirror the repositories according to the settings in the <code class="path">repos.json</code> file to the specified path (in this case, <code class="path">/mnt/usb</code> ).</p>
<div class="listingblock">
<div class="content">
<pre>{prompt.root}rmt-cli export repos /mnt/usb</pre>
</div>
</div>
</li>
<li>
<p>Unmount the storage medium and carry it securely to your  server.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>On the 
server, continue with <a href="#disconnect.mgr.update-repos">Updating Repositories on  From Storage Media</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sub.mgr.tool"><a class="anchor" href="#sub.mgr.tool"></a><a class="link" href="#sub.mgr.tool">{smtool} (SMT) and Disconnected Setup (DMZ)</a></h3>
<div class="paragraph">
<p>The following procedure will guide you through using SMT.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure: SMT: Fetching Repository Data from SUSE Customer Center</div>
<ol class="arabic">
<li>
<p>Configure SMT in the external network with SCC. For details about configuring SMT with SUSE Linux Enterprise 12, see <a href="https://www.suse.com/documentation/sles-12/book_smt/data/book_smt.html" class="bare">https://www.suse.com/documentation/sles-12/book_smt/data/book_smt.html</a>.</p>
</li>
<li>
<p>Using SMT, mirror all required repositories.</p>
</li>
<li>
<p>Create a &#8220;database replacement file&#8221; (for example, <code class="path">/tmp/dbrepl.xml</code> ).</p>
<div class="listingblock">
<div class="content">
<pre>{prompt.root}smt-sync --createdbreplacementfile /tmp/dbrepl.xml</pre>
</div>
</div>
</li>
</ol>
</div>
<div id="pro.mgr.tool.mount.storage" class="olist arabic">
<ol class="arabic">
<li>
<p>Mount a removable storage medium such as an external hard disk or USB flash drive.</p>
</li>
<li>
<p>Export the data to the mounted medium:</p>
<div class="listingblock">
<div class="content">
<pre>smt-sync --todir /media/disk/
smt-mirror --dbreplfile /tmp/dbrepl.xml --directory /media/disk \
           --fromlocalsmt -L /var/log/smt/smt-mirror-export.log</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title=":heavy_exclamation_mark:"></i>
</td>
<td class="content">
<div class="title">Write Permissions for SMT User</div>
The directory being written to must be writeable for the same user as the smt daemon (user=smt). The smt user setting is defined in <code class="path">/etc/smt.conf</code>
.
You can check if the correct user is specified via the following command:
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>{prompt.root}egrep '^smtUser' /etc/smt.conf</pre>
</div>
</div>
<div class="paragraph">
<p>+</p>
</div>
<div class="paragraph">
<p>+
.Keeping the Disconnected Server Up-to-date
NOTE: <code class="command">smt-sync</code> also exports your subscription data.
To keep 
 up-to-date with your subscriptions, you must frequently import and export this data.</p>
</div>
<div class="paragraph">
<p>+</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Unmount the storage medium and carry it securely to your  server.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>On the 
server, continue with <a href="#disconnect.mgr.update-repos">Updating Repositories on  From Storage Media</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="disconnect.mgr.update-repos"><a class="anchor" href="#disconnect.mgr.update-repos"></a><a class="link" href="#disconnect.mgr.update-repos">Updating Repositories on  From Storage Media</a></h3>
<div class="paragraph">
<p>This procedure will show you how to update the repositories on the 
server from the storage media.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure: Updating the Server from the Storage Medium</div>
<ol class="arabic">
<li>
<p>Mount the storage medium on your  server (for example, at <code class="path">/media/disk</code> ).</p>
</li>
<li>
<p>Specify the local path on the  server in <code>/etc/rhn/rhn.conf</code>:</p>
<div class="listingblock">
<div class="content">
<pre>server.susemanager.fromdir = /media/disk</pre>
</div>
</div>
<div class="paragraph">
<p>This setting is mandatory for SUSE Customer Center
and <code class="command">mgr-sync</code>.</p>
</div>
</li>
<li>
<p>Restart Tomcat:</p>
<div class="listingblock">
<div class="content">
<pre>systemctl restart tomcat</pre>
</div>
</div>
</li>
</ol>
</div>
<div id="pro.mgr.tool.sync" class="olist arabic">
<ol class="arabic">
<li>
<p>Before performing another operation on the server execute a full sync:</p>
<div class="listingblock">
<div class="content">
<pre>mgr-sync refresh   # SCC (fromdir in rhn.conf required!)</pre>
</div>
</div>
</li>
<li>
<p><code class="command">mgr-sync</code> can now be executed normally:</p>
<div class="listingblock">
<div class="content">
<pre>mgr-sync list channels
mgr-sync add channel channel-label</pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title=":warning:"></i>
</td>
<td class="content">
<div class="title">Data Corruption</div>
The disk must always be available at the same mount point.
To avoid data corruption, do not trigger a sync, if the storage medium is not mounted.
If you have already added a channel from a local repository path, you will not be able to change its URL to point to a different path afterwards.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Up-to-date data is now available on your 
server and is ready for updating client systems.
According to your maintenance windows or update schedule refresh the data on the storage medium with RMT or SMT.</p>
</div>
</div>
<div class="sect2">
<h3 id="_refreshing_data_on_the_storage_medium"><a class="anchor" href="#_refreshing_data_on_the_storage_medium"></a><a class="link" href="#_refreshing_data_on_the_storage_medium">Refreshing Data on the Storage Medium</a></h3>
<div class="olist arabic">
<div class="title">Procedure: Refreshing Data on the Storage Medium from RMT or SMT</div>
<ol class="arabic">
<li>
<p>On your  server, unmount the storage medium and carry it to your RMT or SMT.</p>
</li>
<li>
<p>On your RMT or SMT system, continue with the synchronization step (either <a href="#pro.rmtool.export.repos">[pro.rmtool.export.repos]</a> or <a href="#pro.mgr.tool.sync">[pro.mgr.tool.sync]</a>).</p>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title=":warning:"></i>
</td>
<td class="content">
<div class="title">Data Corruption</div>
<div class="paragraph">
<p>The storage medium must always be available at the same mount point.
To avoid data corruption, do not trigger a sync if the storage medium is not mounted.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>This concludes using RMT or SMT with 
.</p>
</div>
</div>
</div>
</div>
</article>
  </main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../_/js/site.js"></script>
<script src="../../_/js/vendor/highlight.js"></script>
<script>hljs.initHighlighting()</script>
  </body>
</html>
